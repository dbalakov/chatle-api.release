// Chatle api (version 0.1.11)
(function(){var b;b=function(){function a(f,c,d){this.key=f;this.host=c;this.transport=d;if(null==this.key)throw Error("ChatleClient constructor call without api key");null==this.host&&(this.host=a.DEFAULT_HOST);null==this.transport&&(this.transport=new a.Transport(this.host,this.key));this.auth=new a.Auth(this);this.rooms=new a.Rooms(this);this.users=new a.Users(this)}return a}();b.DEFAULT_HOST="https://chatle.co/system/widgets/_out/api.html";window.ChatleClient=b}).call(this);
(function(){var b;b=function(){function a(a,c){this.frame_url=a;this.key=c;if(null==this.frame_url)throw Error("ChatleClient.Transport constructor call without frame_url");if(null==this.key)throw Error("ChatleClient.Transport constructor call without key");this.iframe=document.createElement("iframe");this.iframe.src=this.frame_url;this.iframe.setAttribute("style","width:0;height:0;display:none");document.body.appendChild(this.iframe);this.queue=[];this.data=null;setInterval(this.interval.bind(this))}
a.prototype.interval=function(){var a,c;if(null!=this.data){a=this.iframe.src.split("#")[1];if(null==a||a===this.data.hash||""===a)return;a=JSON.parse(a);"function"===typeof(c=this.data).callback&&c.callback("ok"===a.status?null:a.errorStatus,"ok"===a.status?a.data:null);this.data=null}return this.sendCommandToFrame()};a.prototype.sendCommandToFrame=function(){if(null==this.data&&0!==this.queue.length)return this.data=this.queue.shift(),this.data.hash=JSON.stringify(this.data.command),this.iframe.src=
""+this.frame_url+"#"+this.data.hash};a.prototype.sendCommand=function(a,c,d,b){this.queue.push({command:{type:a,url:c,data:d,headers:{"X-AppKey":this.key}},callback:b});return this.sendCommandToFrame()};a.prototype.get=function(a,c,b){return this.sendCommand("GET",a,c,b)};a.prototype.post=function(a,c,b){return this.sendCommand("POST",a,c,b)};a.prototype.put=function(a,c,b){return this.sendCommand("PUT",a,c,b)};a.prototype["delete"]=function(a,c,b){return this.sendCommand("DELETE",a,c,b)};return a}();
ChatleClient.Transport=b}).call(this);
(function(){var b;b=function(){function a(a){this.client=a;if(null==this.client)throw Error("ChatleClient.Auth constructor call without client");}a.prototype.registerMobile=function(b,c){return this.client.transport.get(""+a.URL+a.REGISTER_MOBILE_URL,{number:b},c)};a.prototype.registerEmail=function(b,c){return this.client.transport.get(""+a.URL+a.REGISTER_EMAIL_URL,{email:b},c)};a.prototype.confirmCode=function(b,c,d,e){return this.client.transport.get(""+a.URL+a.CONFIRM_CODE_URL,{confirmation_id:b,
code:c,display_name:d},e)};return a}();b.URL="/api/auth/";b.REGISTER_MOBILE_URL="register_mobile";b.REGISTER_EMAIL_URL="email";b.CONFIRM_CODE_URL="confirm_code";ChatleClient.Auth=b}).call(this);
(function(){var b;b=function(){function a(a){this.client=a;if(null==this.client)throw Error("ChatleClient.Rooms constructor call without client");}a.prototype.list=function(b){return this.client.transport.get(""+a.URL,null,b)};a.prototype.messages=function(b,c,d){return this.client.transport.get(""+a.URL+"/"+b,c,d)};a.prototype.sendMessage=function(b,c,d){return this.client.transport.post(""+a.URL+"/"+b+"/"+a.SEND_MESSAGE_URL,{text:c},d)};a.prototype.deleteMessage=function(b,c,d){return this.client.transport["delete"](""+
a.URL+"/"+b+"/"+c,null,d)};a.prototype.createPrivate=function(b,c,d){return this.client.transport.get(""+a.URL+"/"+a.CREATE_PRIVATE_ROOM_URL,{user_id:b,group:c},d)};a.prototype.createInviteOnly=function(b,c,d,e){return this.client.transport.get(""+a.URL+"/"+a.CREATE_INVITE_ONLY_URL,{user_ids:b,group:c,name:d},e)};a.prototype.update=function(b,c,d,e,g,h){return this.client.transport.put(""+a.URL+"/"+b,{group:c,name:d,mute:e,data:g},h)};a.prototype.invite=function(b,c,d){var e;e={};e[c instanceof Array?
"user_ids":"user"]=c;return this.client.transport.get(""+a.URL+"/"+b+"/"+a.INVITE_USERS,e,d)};a.prototype.leave=function(b,c){return this.client.transport.get(""+a.URL+"/"+b+"/"+a.LEAVE,null,c)};return a}();b.URL="/api/rooms";b.SEND_MESSAGE_URL="message";b.CREATE_PRIVATE_ROOM_URL="private";b.CREATE_INVITE_ONLY_URL="group";b.INVITE_USERS="invite";b.LEAVE="leave";ChatleClient.Rooms=b}).call(this);
(function(){var b;b=function(){function a(a){this.client=a;if(null==this.client)throw Error("ChatleClient.Users constructor call without client");}a.prototype.me=function(b){return this.client.transport.get(""+a.URL+"/"+a.ME_URL,null,b)};a.prototype.info=function(b,c){return this.client.transport.get(""+a.URL+"/"+b,null,c)};a.prototype.update=function(b,c,d,e){return this.client.transport.post(""+a.URL+"/"+a.UPDATE_URL,{first_name:b,last_name:c,display_name:d},e)};return a}();b.URL="/api/users";b.ME_URL=
"me";b.UPDATE_URL="me";ChatleClient.Users=b}).call(this);
